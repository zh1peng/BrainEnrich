<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform Brain Gene Set Analysis — brainenrich • BrainEnrich</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform Brain Gene Set Analysis — brainenrich"><meta name="description" content="This function performs gene set analysis using group-level brain data.
It aggregates the associations between gene expression data and brain data within gene sets from annotation data.
The empirical aggregation score is compared to a null distribution generated by the selected null model.
This function supports user-defined correlation and aggregation methods by allowing the use of custom functions."><meta property="og:description" content="This function performs gene set analysis using group-level brain data.
It aggregates the associations between gene expression data and brain data within gene sets from annotation data.
The empirical aggregation score is compared to a null distribution generated by the selected null model.
This function supports user-defined correlation and aggregation methods by allowing the use of custom functions."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BrainEnrich</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/brainenrich_demo.html">brainenrich (demo):Enrichment analysis of group-level IDPs</a></li>
    <li><a class="dropdown-item" href="../articles/brainscore.simulate_demo.html">Simulation analysis of brainscore</a></li>
    <li><a class="dropdown-item" href="../articles/brainscore_demo.html">Enrichment analysis of individual-level IDPs</a></li>
    <li><a class="dropdown-item" href="../articles/hpc_helper_demo.html">How to precompute null gene set scores and do simulation on HPC with slurm</a></li>
    <li><a class="dropdown-item" href="../articles/prepare_annoDat.html">How to prepare gene sets (annoDat) for the analysis</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perform Brain Gene Set Analysis</h1>

      <div class="d-none name"><code>brainenrich.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs gene set analysis using group-level brain data.
It aggregates the associations between gene expression data and brain data within gene sets from annotation data.
The empirical aggregation score is compared to a null distribution generated by the selected null model.
This function supports user-defined correlation and aggregation methods by allowing the use of custom functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">brainenrich</span><span class="op">(</span></span>
<span>  <span class="va">brain_data</span>,</span>
<span>  <span class="va">gene_data</span>,</span>
<span>  <span class="va">annoData</span>,</span>
<span>  cor_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pearson"</span>, <span class="st">"spearman"</span>, <span class="st">"pls1c"</span>, <span class="st">"pls1w"</span><span class="op">)</span>,</span>
<span>  aggre_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"median"</span>, <span class="st">"meanabs"</span>, <span class="st">"meansqr"</span>, <span class="st">"maxmean"</span>, <span class="st">"ks_orig"</span>,</span>
<span>    <span class="st">"ks_weighted"</span>, <span class="st">"ks_pos_neg_sum"</span>, <span class="st">"sign_test"</span>, <span class="st">"rank_sum"</span><span class="op">)</span>,</span>
<span>  null_model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"spin_brain"</span>, <span class="st">"resample_gene"</span>, <span class="st">"coexp_matched"</span><span class="op">)</span>,</span>
<span>  minGSSize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  maxGSSize <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  n_perm <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  perm_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coord.l <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coord.r <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  threshold_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sd"</span>, <span class="st">"percentile"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  threshold_value <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pvalueCutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  pAdjustMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fdr"</span>, <span class="st">"holm"</span>, <span class="st">"hochberg"</span>, <span class="st">"hommel"</span>, <span class="st">"bonferroni"</span>, <span class="st">"BH"</span>, <span class="st">"BY"</span>,</span>
<span>    <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  matchcoexp_tol <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  matchcoexp_max_iter <span class="op">=</span> <span class="fl">1e+06</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-brain-data">brain_data<a class="anchor" aria-label="anchor" href="#arg-brain-data"></a></dt>
<dd><p>A data frame of brain data with regions as rows. The row names (i.e., region names) must be consistent with those in gene_data.</p></dd>


<dt id="arg-gene-data">gene_data<a class="anchor" aria-label="anchor" href="#arg-gene-data"></a></dt>
<dd><p>A data frame of gene expression data with regions as rows and genes as columns. The row names (i.e., region names) must be consistent with those in brain_data.</p></dd>


<dt id="arg-annodata">annoData<a class="anchor" aria-label="anchor" href="#arg-annodata"></a></dt>
<dd><p>An environment containing annotation data. See <code>get_annoData</code> for more details.</p></dd>


<dt id="arg-cor-method">cor_method<a class="anchor" aria-label="anchor" href="#arg-cor-method"></a></dt>
<dd><p>A character string specifying the correlation method.
Default is 'pearson'. Other options include 'spearman', 'pls1c',
and 'pls1w'. If a custom function that takes (gene_data, brain_data) as input is provided, the function will use the custom correlation method, and <code>cor_method</code> will be set to 'custom'.</p></dd>


<dt id="arg-aggre-method">aggre_method<a class="anchor" aria-label="anchor" href="#arg-aggre-method"></a></dt>
<dd><p>A character string specifying the aggregation method.
Default is 'mean'. Other options include 'median', 'meanabs',
'meansqr', 'maxmean', 'ks_orig', 'ks_weighted', 'ks_pos_neg_sum',
'sign_test', and 'rank_sum'. If a custom function that takes (geneList, geneSet) as input is provided, the function will use the custom aggregation method, and <code>aggre_method</code> will be set to 'custom'.</p></dd>


<dt id="arg-null-model">null_model<a class="anchor" aria-label="anchor" href="#arg-null-model"></a></dt>
<dd><p>A character string specifying the null model to use.
Default is 'spin_brain'. Other options include 'resample_gene' and 'coexp_matched'.</p></dd>


<dt id="arg-mingssize">minGSSize<a class="anchor" aria-label="anchor" href="#arg-mingssize"></a></dt>
<dd><p>An integer specifying the minimum gene set size after intersecting with the genes in gene_data. Default is 10.</p></dd>


<dt id="arg-maxgssize">maxGSSize<a class="anchor" aria-label="anchor" href="#arg-maxgssize"></a></dt>
<dd><p>An integer specifying the maximum gene set size after intersecting with the genes in gene_data. Default is 200.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>An integer specifying the number of cores to use. Default is 0 (use all available cores minus one).</p></dd>


<dt id="arg-n-perm">n_perm<a class="anchor" aria-label="anchor" href="#arg-n-perm"></a></dt>
<dd><p>An integer specifying the number of permutations. Default is 5000.</p></dd>


<dt id="arg-perm-id">perm_id<a class="anchor" aria-label="anchor" href="#arg-perm-id"></a></dt>
<dd><p>A matrix of permutation indices for the 'spin_brain' null model. Default is NULL. Either perm_id or coord.l/coord.r must be provided if choosing the 'spin_brain' mode.</p></dd>


<dt id="arg-coord-l">coord.l<a class="anchor" aria-label="anchor" href="#arg-coord-l"></a></dt>
<dd><p>A matrix of coordinates for the left hemisphere used in the 'spin_brain' null model. Default is NULL. Can be NULL if coord.r or perm_id is provided.</p></dd>


<dt id="arg-coord-r">coord.r<a class="anchor" aria-label="anchor" href="#arg-coord-r"></a></dt>
<dd><p>A matrix of coordinates for the right hemisphere used in the 'spin_brain' null model. Default is NULL. Can be NULL if coord.l or perm_id is provided.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>An integer specifying the seed for reproducibility when using the 'spin_brain' model. Default is NULL.</p></dd>


<dt id="arg-threshold-type">threshold_type<a class="anchor" aria-label="anchor" href="#arg-threshold-type"></a></dt>
<dd><p>A character string specifying the threshold type for identifying core genes.
Default is 'sd'. Other options are 'percentile' and 'none'. For 'sd', the threshold value represents the number of standard deviations from the mean. For 'percentile', the threshold value represents the percentile of the distribution. For 'none', no identification of core genes is performed.</p></dd>


<dt id="arg-threshold-value">threshold_value<a class="anchor" aria-label="anchor" href="#arg-threshold-value"></a></dt>
<dd><p>A numeric value specifying the threshold for core gene identification. Default is 1. See <code>find_core_genes</code> for more details.</p></dd>


<dt id="arg-pvaluecutoff">pvalueCutoff<a class="anchor" aria-label="anchor" href="#arg-pvaluecutoff"></a></dt>
<dd><p>A numeric value specifying the p-value cutoff for significance in the output. Default is 0.05.</p></dd>


<dt id="arg-padjustmethod">pAdjustMethod<a class="anchor" aria-label="anchor" href="#arg-padjustmethod"></a></dt>
<dd><p>A character string specifying the method for p-value adjustment ("fdr", "holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "none").
Default is 'fdr'. See <code>p.adjust</code> for more details.</p></dd>


<dt id="arg-matchcoexp-tol">matchcoexp_tol<a class="anchor" aria-label="anchor" href="#arg-matchcoexp-tol"></a></dt>
<dd><p>A numeric value specifying the tolerance for co-expression matching in the 'coexp_matched' null model.
Lower values result in better matching but increase the number of iterations required. Default is 0.05. See <code>resample_geneSetList_matching_coexp</code> for more details.</p></dd>


<dt id="arg-matchcoexp-max-iter">matchcoexp_max_iter<a class="anchor" aria-label="anchor" href="#arg-matchcoexp-max-iter"></a></dt>
<dd><p>An integer specifying the maximum number of iterations
for co-expression matching in the 'coexp_matched' null model. Default is 1,000,000. See <code>resample_geneSetList_matching_coexp</code> for more details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A gseaResult object containing the enrichment results.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhipeng Cao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

