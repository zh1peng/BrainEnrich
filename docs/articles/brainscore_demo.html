<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Individual-level enrichment analysis (brainscore/brainscore.lm_test) • BrainEnrich</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Individual-level enrichment analysis (brainscore/brainscore.lm_test)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BrainEnrich</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/annoData_demo.html">Preparison of gene sets (annoData)</a></li>
    <li><a class="dropdown-item" href="../articles/brainenrich_demo.html">Group-level Enrichment Analysis (brainenrich)</a></li>
    <li><a class="dropdown-item" href="../articles/brainscore_demo.html">Individual-level enrichment analysis (brainscore/brainscore.lm_test)</a></li>
    <li><a class="dropdown-item" href="../articles/brainscore.simulate_demo.html">Simulation analysis (brainscore.simulate)</a></li>
    <li><a class="dropdown-item" href="../articles/hpc_demo.html">Computation on HPC with slurm</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="brainscore_demo_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="brainscore_demo_files/kePrint-0.0.1/kePrint.js"></script><link href="brainscore_demo_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Individual-level enrichment analysis (brainscore/brainscore.lm_test)</h1>
            
      

      <div class="d-none name"><code>brainscore_demo.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This tutorial demonstrates how to perform enrichment analysis of individual-level imaging-derived phenotypes (IDPs) using the BrainEnrich package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://zh1peng.github.io/BrainEnrich/" class="external-link">BrainEnrich</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/biomedical-knowledge-mining-book/" class="external-link">enrichplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prepare-data-for-the-analysis">1. Prepare Data for the Analysis<a class="anchor" aria-label="anchor" href="#prepare-data-for-the-analysis"></a>
</h2>
<p>In this section, we will prepare the data needed for individual-level enrichment analysis.</p>
<p>Note that for demonstration purpose, the data used here is simulated from the HCP dataset.</p>
<div class="section level3">
<h3 id="load-sample-data-frame--the-data-is-simulated-from-hcp-data-">1.1. Load sample data frame. The data is simulated from HCP data.<a class="anchor" aria-label="anchor" href="#load-sample-data-frame--the-data-is-simulated-from-hcp-data-"></a>
</h3>
<p>The data is simulated from HCP data. Let’s load and inspect it.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim_hcp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sim_hcp</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    100 obs. of  37 variables:</span></span>
<span><span class="co">#&gt;  $ L_bankssts                : num  2.56 2.48 2.47 2.63 2.48 ...</span></span>
<span><span class="co">#&gt;  $ L_caudalanteriorcingulate : num  2.56 2.7 2.63 2.48 2.43 ...</span></span>
<span><span class="co">#&gt;  $ L_caudalmiddlefrontal     : num  2.52 2.75 2.57 2.67 2.68 ...</span></span>
<span><span class="co">#&gt;  $ L_cuneus                  : num  1.7 1.92 1.87 1.87 1.85 ...</span></span>
<span><span class="co">#&gt;  $ L_entorhinal              : num  3.51 3.38 3.38 3.15 2.63 ...</span></span>
<span><span class="co">#&gt;  $ L_fusiform                : num  2.57 2.64 2.7 2.55 2.56 ...</span></span>
<span><span class="co">#&gt;  $ L_inferiorparietal        : num  2.42 2.51 2.51 2.56 2.54 ...</span></span>
<span><span class="co">#&gt;  $ L_inferiortemporal        : num  2.55 2.71 2.76 2.8 2.76 ...</span></span>
<span><span class="co">#&gt;  $ L_isthmuscingulate        : num  2.18 2.54 2.43 2.41 2.47 ...</span></span>
<span><span class="co">#&gt;  $ L_lateraloccipital        : num  2 2.25 2.21 2.17 2.29 ...</span></span>
<span><span class="co">#&gt;  $ L_lateralorbitofrontal    : num  2.79 2.77 2.7 2.84 2.67 ...</span></span>
<span><span class="co">#&gt;  $ L_lingual                 : num  1.84 2.07 2.11 2.12 2.07 ...</span></span>
<span><span class="co">#&gt;  $ L_medialorbitofrontal     : num  2.54 2.43 2.41 2.68 2.45 ...</span></span>
<span><span class="co">#&gt;  $ L_middletemporal          : num  2.75 2.64 2.8 2.9 2.81 ...</span></span>
<span><span class="co">#&gt;  $ L_parahippocampal         : num  2.88 2.47 2.68 3.1 2.98 ...</span></span>
<span><span class="co">#&gt;  $ L_paracentral             : num  2.32 2.43 2.38 2.56 2.47 ...</span></span>
<span><span class="co">#&gt;  $ L_parsopercularis         : num  2.63 2.67 2.47 2.57 2.72 ...</span></span>
<span><span class="co">#&gt;  $ L_parsorbitalis           : num  2.86 2.74 3.08 2.78 2.61 ...</span></span>
<span><span class="co">#&gt;  $ L_parstriangularis        : num  2.44 2.39 2.54 2.51 2.47 ...</span></span>
<span><span class="co">#&gt;  $ L_pericalcarine           : num  1.3 1.87 1.86 1.82 1.61 ...</span></span>
<span><span class="co">#&gt;  $ L_postcentral             : num  1.74 2.18 2.14 2.42 2.13 ...</span></span>
<span><span class="co">#&gt;  $ L_posteriorcingulate      : num  2.34 2.72 2.32 2.38 2.52 ...</span></span>
<span><span class="co">#&gt;  $ L_precentral              : num  2.54 2.7 2.69 2.79 2.64 ...</span></span>
<span><span class="co">#&gt;  $ L_precuneus               : num  2.26 2.35 2.31 2.34 2.36 ...</span></span>
<span><span class="co">#&gt;  $ L_rostralanteriorcingulate: num  3.06 2.72 2.91 2.57 2.83 ...</span></span>
<span><span class="co">#&gt;  $ L_rostralmiddlefrontal    : num  2.34 2.42 2.39 2.57 2.49 ...</span></span>
<span><span class="co">#&gt;  $ L_superiorfrontal         : num  2.81 2.83 2.71 2.77 2.85 ...</span></span>
<span><span class="co">#&gt;  $ L_superiorparietal        : num  2.06 2.24 2.16 2.35 2.29 ...</span></span>
<span><span class="co">#&gt;  $ L_superiortemporal        : num  2.73 2.9 2.91 3.09 2.86 ...</span></span>
<span><span class="co">#&gt;  $ L_supramarginal           : num  2.42 2.48 2.62 2.71 2.62 ...</span></span>
<span><span class="co">#&gt;  $ L_frontalpole             : num  2.8 2.75 3.1 2.87 3.29 ...</span></span>
<span><span class="co">#&gt;  $ L_temporalpole            : num  3.52 3.44 3.89 3.67 2.87 ...</span></span>
<span><span class="co">#&gt;  $ L_transversetemporal      : num  2.16 2.64 2.71 2.58 2.47 ...</span></span>
<span><span class="co">#&gt;  $ L_insula                  : num  2.83 3.23 2.95 3.16 3.04 ...</span></span>
<span><span class="co">#&gt;  $ Age                       : int  29 28 36 29 28 27 29 26 34 31 ...</span></span>
<span><span class="co">#&gt;  $ Sex                       : Factor w/ 2 levels "0","1": 2 1 1 1 1 2 1 1 2 2 ...</span></span>
<span><span class="co">#&gt;  $ BMI                       : num  37.2 23.8 30.1 32.1 25.7 ...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="prepare-brain_data-for-scoring">1.2. prepare brain_data for scoring<a class="anchor" aria-label="anchor" href="#prepare-brain_data-for-scoring"></a>
</h3>
<p>Next, we’ll prepare the brain data by selecting the relevant columns and transforming the data for scoring.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brain_data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sim_hcp</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"L_"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">brain_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sub-"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">brain_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">brain_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;  num [1:34, 1:100] 2.56 2.56 2.52 1.7 3.51 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:34] "L_bankssts" "L_caudalanteriorcingulate" "L_caudalmiddlefrontal" "L_cuneus" ...</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:100] "sub-1" "sub-2" "sub-3" "sub-4" ...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-gene-expression-data-for-the-analysis">1.3. Load gene expression data for the Analysis<a class="anchor" aria-label="anchor" href="#load-gene-expression-data-for-the-analysis"></a>
</h3>
<p>We will now load gene expression data for the analysis. This data is based on a specific brain atlas (Desikan) and includes gene expression levels (correlation across donnors &gt; 0.4) for the left hemisphere.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_geneExp.html">get_geneExp</a></span><span class="op">(</span>atlas <span class="op">=</span> <span class="st">"desikan"</span>, rdonor <span class="op">=</span> <span class="st">"r0.4"</span>, hem <span class="op">=</span> <span class="st">"L"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">gene_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;  num [1:34, 1:6513] 0.469 0.607 0.512 0.341 0.664 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:34] "L_bankssts" "L_caudalanteriorcingulate" "L_caudalmiddlefrontal" "L_cuneus" ...</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:6513] "A1BG" "A1BG-AS1" "AACS" "AADAT" ...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-syngo-for-the-analysis">1.4. Load SynGO for the Analysis<a class="anchor" aria-label="anchor" href="#load-syngo-for-the-analysis"></a>
</h3>
<p>We will load SynGO terms that will be used in the enrichment analysis. This data represents gene sets associated with various molecular functions.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annoData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_annoData.html">get_annoData</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SynGO"</span><span class="op">)</span></span>
<span><span class="va">geneSetList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_geneSetList.html">get_geneSetList</a></span><span class="op">(</span><span class="va">annoData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">geneSetList</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 302</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Number of SynGO terms: %d"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">geneSetList</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Number of SynGO terms: 302"</span></span></code></pre></div>
<div class="section level4">
<h4 id="filter-the-genesetlist-optional">Filter the geneSetList (Optional)<a class="anchor" aria-label="anchor" href="#filter-the-genesetlist-optional"></a>
</h4>
<p>Filtering the gene sets by size is optional and is shown here for demonstration purposes. This step is embedded in the brainenrich/brainscore function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">selected.gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_geneSetList.html">filter_geneSetList</a></span><span class="op">(</span>bg_genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gene_data</span><span class="op">)</span>, geneSetList <span class="op">=</span> <span class="va">geneSetList</span>, minGSSize <span class="op">=</span> <span class="fl">20</span>, maxGSSize <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%d MF terms have gene size ranging between 20 and 200"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">selected.gs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="get-gene-set-scores-using-brainscore">2. Get gene set scores using <code>brainscore</code><a class="anchor" aria-label="anchor" href="#get-gene-set-scores-using-brainscore"></a>
</h2>
<p>In this section, we will run the individual enrichment analysis using the prepared data.</p>
<div class="section level3">
<h3 id="get-the-raw-empirical-score-of-the-brain_data-null_modelnone">2.1. get the raw (empirical) score of the brain_data (<code>null_model='none'</code>)<a class="anchor" aria-label="anchor" href="#get-the-raw-empirical-score-of-the-brain_data-null_modelnone"></a>
</h3>
<p>We calculate the gene set scores for the brain data without using any null model.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gsScore.raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brainscore.html">brainscore</a></span><span class="op">(</span></span>
<span>  brain_data <span class="op">=</span> <span class="va">brain_data</span>,</span>
<span>  gene_data <span class="op">=</span> <span class="va">gene_data</span>,</span>
<span>  annoData <span class="op">=</span> <span class="va">annoData</span>,</span>
<span>  cor_method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  aggre_method <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  minGSSize <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  maxGSSize <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  null_model <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gsScore.raw</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 6</span></span>
<span><span class="co">#&gt;  $ GO:0007268: num [1:100] 0.0588 0.0278 -0.013 0.0465 0.0445 ...</span></span>
<span><span class="co">#&gt;  $ GO:0007416: num [1:100] 0.1185 0.0785 0.0442 0.1009 0.088 ...</span></span>
<span><span class="co">#&gt;  $ GO:0008021: num [1:100] 0.25 0.216 0.148 0.223 0.216 ...</span></span>
<span><span class="co">#&gt;  $ GO:0016079: num [1:100] -0.0939 -0.0846 -0.1204 -0.0569 -0.0439 ...</span></span>
<span><span class="co">#&gt;  $ GO:0030285: num [1:100] 0.1037 0.1043 0.0359 0.1126 0.1658 ...</span></span>
<span><span class="co">#&gt;  $ GO:0030672: num [1:100] 0.277 0.242 0.174 0.247 0.252 ...</span></span></code></pre></div>
<p>The gsScore.raw is a list of molecular terms. For each molecular term, you can find individual gene set scores and use them for downstream analyses (e.g., correlation analysis, machine learning, clustering etc.).</p>
</div>
<div class="section level3">
<h3 id="get-the-null-score-of-the-brain_data-null_modelspin_brain">2.2. Get the null score of the brain_data (<code>null_model='spin_brain'</code>)<a class="anchor" aria-label="anchor" href="#get-the-null-score-of-the-brain_data-null_modelspin_brain"></a>
</h3>
<p>Next, we will calculate the null scores using the ‘spin_brain’ null model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gsScore.spin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brainscore.html">brainscore</a></span><span class="op">(</span></span>
<span>  brain_data <span class="op">=</span> <span class="va">brain_data</span>,</span>
<span>  gene_data <span class="op">=</span> <span class="va">gene_data</span>,</span>
<span>  annoData <span class="op">=</span> <span class="va">annoData</span>,</span>
<span>  cor_method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  aggre_method <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  minGSSize <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  maxGSSize <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  null_model <span class="op">=</span> <span class="st">"spin_brain"</span>,</span>
<span>  n_perm <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  perm_id <span class="op">=</span> <span class="va">perm_id_dk_lh_5000</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gsScore.spin</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ null_1:List of 55</span></span>
<span><span class="co">#&gt;  $ null_2:List of 55</span></span>
<span><span class="co">#&gt;  $ null_3:List of 55</span></span>
<span><span class="co">#&gt;  $ null_4:List of 55</span></span>
<span><span class="co">#&gt;  $ null_5:List of 55</span></span></code></pre></div>
<p>The result is a list of lists. Each sublist contains null scores for the molecular terms (i.e. SynGO terms). This is useful for permutation tests, where you compare the observed results (e.g., correlation) with your dependent variable between empirical gsScore and null model gsScore.</p>
</div>
<div class="section level3">
<h3 id="get-the-null-score-of-the-resample_gene-set-null_modelresample_gene">2.3. Get the null score of the resample_gene (<code>set null_model='resample_gene'</code>)<a class="anchor" aria-label="anchor" href="#get-the-null-score-of-the-resample_gene-set-null_modelresample_gene"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gsScore.resample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brainscore.html">brainscore</a></span><span class="op">(</span></span>
<span>  brain_data <span class="op">=</span> <span class="va">brain_data</span>,</span>
<span>  gene_data <span class="op">=</span> <span class="va">gene_data</span>,</span>
<span>  annoData <span class="op">=</span> <span class="va">annoData</span>,</span>
<span>  cor_method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  aggre_method <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  minGSSize <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  maxGSSize <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  null_model <span class="op">=</span> <span class="st">"resample_gene"</span>,</span>
<span>  n_perm <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gsScore.resample</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ null_1:List of 55</span></span>
<span><span class="co">#&gt;  $ null_2:List of 55</span></span>
<span><span class="co">#&gt;  $ null_3:List of 55</span></span>
<span><span class="co">#&gt;  $ null_4:List of 55</span></span>
<span><span class="co">#&gt;  $ null_5:List of 55</span></span></code></pre></div>
<p>The result is also a list of lists. Each sublist contains null scores for the molecular terms (i.e. SynGO terms). This is useful for permutation tests, where you compare the observed results (e.g., correlation) with your dependent variable between empirical gsScore and null model gsScore.</p>
</div>
</div>
<div class="section level2">
<h2 id="perform-linear-regression-between-the-gsscore-and-predictors-using-brainscore-lm_test">3. Perform linear regression between the gsScore and predictors using <code>brainscore.lm_test</code><a class="anchor" aria-label="anchor" href="#perform-linear-regression-between-the-gsscore-and-predictors-using-brainscore-lm_test"></a>
</h2>
<p>The function brainscore.lm_test is designed to perform linear regression tests between the gsScore and the brain data as follows: <code>gsScore ~ predictor + covariates</code>. This would cover scenarios where gsScores will be used. The predictor can be either a single numeric variable or a single two-level factor variable. The covariates can be a data frame with multiple numeric variables or factors. The function will first get the emprical statistics (i.e., standardized beta corresponding to the predictor) and then test that against the null model (e.g., spin_brain) to get the p-value.</p>
<div class="section level3">
<h3 id="normal-setup">Normal setup<a class="anchor" aria-label="anchor" href="#normal-setup"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cov_df</span> <span class="op">&lt;-</span> <span class="va">sim_hcp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Age</span>, <span class="va">Sex</span><span class="op">)</span></span>
<span><span class="va">pred_df</span> <span class="op">&lt;-</span> <span class="va">sim_hcp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">BMI</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brainscore.lm_test.html">brainscore.lm_test</a></span><span class="op">(</span></span>
<span>  pred_df <span class="op">=</span> <span class="va">pred_df</span>,</span>
<span>  cov_df <span class="op">=</span> <span class="va">cov_df</span>,</span>
<span>  brain_data <span class="op">=</span> <span class="va">brain_data</span>,</span>
<span>  gene_data <span class="op">=</span> <span class="va">gene_data</span>,</span>
<span>  annoData <span class="op">=</span> <span class="va">annoData</span>,</span>
<span>  cor_method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  aggre_method <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  minGSSize <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  maxGSSize <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  null_model <span class="op">=</span> <span class="st">"spin_brain"</span>,</span>
<span>  n_perm <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  perm_id <span class="op">=</span> <span class="va">perm_id_dk_lh_5000</span>,</span>
<span>  pvalueCutoff <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For demonstration purposes, we only performed 10 permutations and set minGSSize to 50. In practice, you may need to perform more permutations (e.g., 5000) for a more reliable p-value.</p>
</div>
<div class="section level3">
<h3 id="setup-with-precomputed-null-scores">Setup with precomputed null scores<a class="anchor" aria-label="anchor" href="#setup-with-precomputed-null-scores"></a>
</h3>
<p>As an alternative to the previous step, you can use precomputed null scores to perform linear regression tests between the gsScore and the brain data. Generating null brain scores can be time consuming, especially when the number of permutations is high. Therefore, we recommend using precomputed null scores for the analysis. Here we used the null scores generated in Section 2.2.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brainscore.lm_test.html">brainscore.lm_test</a></span><span class="op">(</span></span>
<span>  pred_df <span class="op">=</span> <span class="va">pred_df</span>,</span>
<span>  cov_df <span class="op">=</span> <span class="va">cov_df</span>,</span>
<span>  brain_data <span class="op">=</span> <span class="va">brain_data</span>,</span>
<span>  gene_data <span class="op">=</span> <span class="va">gene_data</span>,</span>
<span>  annoData <span class="op">=</span> <span class="va">annoData</span>,</span>
<span>  gsScoreList.null <span class="op">=</span> <span class="va">gsScore.spin</span>,</span>
<span>  cor_method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  aggre_method <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  minGSSize <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  maxGSSize <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  null_model <span class="op">=</span> <span class="st">"spin_brain"</span>,</span>
<span>  n_perm <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  pvalueCutoff <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The attribute of the gsScoreList.null should be the same as your input of the function for these variables: cor_method, aggre_method, minGSSize, maxGSSize, null_model, n_perm, if not, that means the gsScoreList.null is not usable for the currrent setup.</p>
<p>Note that the output of the brainscore.lm_test function is gseaResult object. Some methods and functions are available for this object. For example, you can convert it to dataframe easily and visualize the results (see section below).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co"># make scollable table</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">res.df</span>, format <span class="op">=</span> <span class="st">"html"</span>, escape <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="st">"striped"</span>, full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/scroll_box.html" class="external-link">scroll_box</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="st">"400px"</span><span class="op">)</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
ID
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Description
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
setSize
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Predictor
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Unstandardized_Coefficient
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Standard_Error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
t_Value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Standardized_Coefficient
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
CI_95_Lower
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
CI_95_Upper
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pvalue
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.adjust
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
qvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
null_model
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
core_enrichment
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="GO:0007268" class="uri">GO:0007268</a>
</td>
<td style="text-align:left;">
<a href="GO:0007268" class="uri">GO:0007268</a>
</td>
<td style="text-align:left;">
chemical synaptic transmission (<a href="GO:0007268" class="uri">GO:0007268</a>)
</td>
<td style="text-align:right;">
109
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0013914
</td>
<td style="text-align:right;">
0.0004921
</td>
<td style="text-align:right;">
2.827405
</td>
<td style="text-align:right;">
0.2746981
</td>
<td style="text-align:right;">
0.0818458
</td>
<td style="text-align:right;">
0.4675503
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
AKAP12/PDE4A/NCAN/PACSIN2/DLGAP3/CAMKV/RPS6KB1/CHRNA4/GRM8/NR3C2/NRN1/SYT12/OPRM1/NRXN2/PLCB1/INA/NEFL/NEFH/ATG5
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0007416" class="uri">GO:0007416</a>
</td>
<td style="text-align:left;">
<a href="GO:0007416" class="uri">GO:0007416</a>
</td>
<td style="text-align:left;">
synapse assembly (<a href="GO:0007416" class="uri">GO:0007416</a>)
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0010665
</td>
<td style="text-align:right;">
0.0004921
</td>
<td style="text-align:right;">
2.167452
</td>
<td style="text-align:right;">
0.2148880
</td>
<td style="text-align:right;">
0.0180905
</td>
<td style="text-align:right;">
0.4116856
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
CADM1/EFNB2/SDC2/LRRTM1/NRG1/FARP1/GRID2/LRRC4B/GPC4/NUMBL/CPEB3/PALM/PDLIM5/SYNDIG1/DCLK1/DOCK4/FLRT2/ASIC1
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0008021" class="uri">GO:0008021</a>
</td>
<td style="text-align:left;">
<a href="GO:0008021" class="uri">GO:0008021</a>
</td>
<td style="text-align:left;">
synaptic vesicle (<a href="GO:0008021" class="uri">GO:0008021</a>)
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0018788
</td>
<td style="text-align:right;">
0.0007204
</td>
<td style="text-align:right;">
2.607986
</td>
<td style="text-align:right;">
0.2542290
</td>
<td style="text-align:right;">
0.0607308
</td>
<td style="text-align:right;">
0.4477271
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
TRIM9/BRSK1/DTNBP1/SH3GL2/GNAO1/GNB2/VAMP1/MAL2/SLC17A8/OPRK1/SV2B/SYT12/ATP6V0A4
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0016079" class="uri">GO:0016079</a>
</td>
<td style="text-align:left;">
<a href="GO:0016079" class="uri">GO:0016079</a>
</td>
<td style="text-align:left;">
synaptic vesicle exocytosis (<a href="GO:0016079" class="uri">GO:0016079</a>)
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0009755
</td>
<td style="text-align:right;">
0.0004370
</td>
<td style="text-align:right;">
2.232404
</td>
<td style="text-align:right;">
0.2221946
</td>
<td style="text-align:right;">
0.0246260
</td>
<td style="text-align:right;">
0.4197632
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
UNC13C/STX1B/MCTP1/DOC2A/PRKCG/GIT2/SV2B/NPY1R/BRSK1
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0030672" class="uri">GO:0030672</a>
</td>
<td style="text-align:left;">
<a href="GO:0030672" class="uri">GO:0030672</a>
</td>
<td style="text-align:left;">
synaptic vesicle membrane (<a href="GO:0030672" class="uri">GO:0030672</a>)
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0019300
</td>
<td style="text-align:right;">
0.0007385
</td>
<td style="text-align:right;">
2.613354
</td>
<td style="text-align:right;">
0.2545216
</td>
<td style="text-align:right;">
0.0611986
</td>
<td style="text-align:right;">
0.4478446
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
CLTA/SH3GL2/GNAO1/GNB2/ATP6V1G2/VAMP1/MAL2/SLC17A8/OPRK1/SV2B/SYT9/SYT12/ATP6V0A4
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0042734" class="uri">GO:0042734</a>
</td>
<td style="text-align:left;">
<a href="GO:0042734" class="uri">GO:0042734</a>
</td>
<td style="text-align:left;">
presynaptic membrane (<a href="GO:0042734" class="uri">GO:0042734</a>)
</td>
<td style="text-align:right;">
103
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0014652
</td>
<td style="text-align:right;">
0.0005742
</td>
<td style="text-align:right;">
2.551639
</td>
<td style="text-align:right;">
0.2506532
</td>
<td style="text-align:right;">
0.0556638
</td>
<td style="text-align:right;">
0.4456425
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
SNPH/KCTD16/KCTD12/GNAO1/GNB5/RGS7/CTNNA2/EPHB2/ADCY8/EFNB2/CNR1/CACNA1C/NRXN1/CHRNA4/HTR1A/VAPB/DRD1/IGSF8/ABCC8
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0045211" class="uri">GO:0045211</a>
</td>
<td style="text-align:left;">
<a href="GO:0045211" class="uri">GO:0045211</a>
</td>
<td style="text-align:left;">
postsynaptic membrane (<a href="GO:0045211" class="uri">GO:0045211</a>)
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0012215
</td>
<td style="text-align:right;">
0.0004954
</td>
<td style="text-align:right;">
2.465768
</td>
<td style="text-align:right;">
0.2427001
</td>
<td style="text-align:right;">
0.0473225
</td>
<td style="text-align:right;">
0.4380776
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
NTRK2/KCTD12/KCTD16/GNAO1/TENM2/FBXO2/KCNA2/EPHB2/FXYD6/SLC8A1/ADRA2C/GRIA3/ABHD6/KCNN2/HCN1/SDC2/CADM2
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0048786" class="uri">GO:0048786</a>
</td>
<td style="text-align:left;">
<a href="GO:0048786" class="uri">GO:0048786</a>
</td>
<td style="text-align:left;">
presynaptic active zone (<a href="GO:0048786" class="uri">GO:0048786</a>)
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0014962
</td>
<td style="text-align:right;">
0.0005709
</td>
<td style="text-align:right;">
2.620828
</td>
<td style="text-align:right;">
0.2579514
</td>
<td style="text-align:right;">
0.0625820
</td>
<td style="text-align:right;">
0.4533208
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
FLOT1/PI4K2A/ERC1/ERC2/NR3C2/FLOT2/CACNA2D2/SCN8A/GRM7/GRIA1/GABRA2/KCNJ8/GRM8/HCN1/GRIA3/NRXN2
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0050804" class="uri">GO:0050804</a>
</td>
<td style="text-align:left;">
<a href="GO:0050804" class="uri">GO:0050804</a>
</td>
<td style="text-align:left;">
modulation of chemical synaptic transmission (<a href="GO:0050804" class="uri">GO:0050804</a>)
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0010765
</td>
<td style="text-align:right;">
0.0004931
</td>
<td style="text-align:right;">
2.183228
</td>
<td style="text-align:right;">
0.2157757
</td>
<td style="text-align:right;">
0.0195931
</td>
<td style="text-align:right;">
0.4119582
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
ADCY8/AKAP12/PDE4A/PPP1R9A/DGKB/NCAN/SHANK1/CAMKV/RPS6KB1
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0051963" class="uri">GO:0051963</a>
</td>
<td style="text-align:left;">
<a href="GO:0051963" class="uri">GO:0051963</a>
</td>
<td style="text-align:left;">
regulation of synapse assembly (<a href="GO:0051963" class="uri">GO:0051963</a>)
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0009248
</td>
<td style="text-align:right;">
0.0004219
</td>
<td style="text-align:right;">
2.191853
</td>
<td style="text-align:right;">
0.2178028
</td>
<td style="text-align:right;">
0.0205564
</td>
<td style="text-align:right;">
0.4150492
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
SDC2/LRRC4B/NUMBL/CPEB3/PALM/PDLIM5/DCLK1/DOCK4/ASIC1
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0098839" class="uri">GO:0098839</a>
</td>
<td style="text-align:left;">
<a href="GO:0098839" class="uri">GO:0098839</a>
</td>
<td style="text-align:left;">
postsynaptic density membrane (<a href="GO:0098839" class="uri">GO:0098839</a>)
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0014867
</td>
<td style="text-align:right;">
0.0005539
</td>
<td style="text-align:right;">
2.683837
</td>
<td style="text-align:right;">
0.2632578
</td>
<td style="text-align:right;">
0.0685505
</td>
<td style="text-align:right;">
0.4579650
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
RGS9/MDGA1/ADCY1/EFNB2/SCN8A/ADRA2C/DCC/CACNG3/GRID2/LRRC4B/PTPRT/SHISA6/GRIA3/SEMA4F/TMEM108/ASIC1
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0099055" class="uri">GO:0099055</a>
</td>
<td style="text-align:left;">
<a href="GO:0099055" class="uri">GO:0099055</a>
</td>
<td style="text-align:left;">
integral component of postsynaptic membrane (<a href="GO:0099055" class="uri">GO:0099055</a>)
</td>
<td style="text-align:right;">
76
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0015037
</td>
<td style="text-align:right;">
0.0006345
</td>
<td style="text-align:right;">
2.369779
</td>
<td style="text-align:right;">
0.2338337
</td>
<td style="text-align:right;">
0.0379689
</td>
<td style="text-align:right;">
0.4296984
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
EPHB2/CACNA1H/FXYD6/SLC6A6/GRIA3/ITGB1/DRD1/KCNN2/ADGRL3/CADM2/CACNA1A
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0099056" class="uri">GO:0099056</a>
</td>
<td style="text-align:left;">
<a href="GO:0099056" class="uri">GO:0099056</a>
</td>
<td style="text-align:left;">
integral component of presynaptic membrane (<a href="GO:0099056" class="uri">GO:0099056</a>)
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0017934
</td>
<td style="text-align:right;">
0.0007413
</td>
<td style="text-align:right;">
2.419248
</td>
<td style="text-align:right;">
0.2385934
</td>
<td style="text-align:right;">
0.0428284
</td>
<td style="text-align:right;">
0.4343584
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
EPHB2/KCNQ5/ADCY8/EFNB2/CNR1/CACNA1C/CHRNA4/HTR1A/VAPB/IGSF8/ABCC8
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0099061" class="uri">GO:0099061</a>
</td>
<td style="text-align:left;">
<a href="GO:0099061" class="uri">GO:0099061</a>
</td>
<td style="text-align:left;">
integral component of postsynaptic density membrane (<a href="GO:0099061" class="uri">GO:0099061</a>)
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0015592
</td>
<td style="text-align:right;">
0.0005803
</td>
<td style="text-align:right;">
2.687153
</td>
<td style="text-align:right;">
0.2633527
</td>
<td style="text-align:right;">
0.0688156
</td>
<td style="text-align:right;">
0.4578898
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
ADCY1/EFNB2/SCN8A/ADRA2C/DCC/GRID2/LRRC4B/LRRC7/SHISA6/GRIA3/SEMA4F/TMEM108/ASIC1
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0099072" class="uri">GO:0099072</a>
</td>
<td style="text-align:left;">
<a href="GO:0099072" class="uri">GO:0099072</a>
</td>
<td style="text-align:left;">
regulation of postsynaptic membrane neurotransmitter receptor levels (<a href="GO:0099072" class="uri">GO:0099072</a>)
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0013138
</td>
<td style="text-align:right;">
0.0004926
</td>
<td style="text-align:right;">
2.667087
</td>
<td style="text-align:right;">
0.2605179
</td>
<td style="text-align:right;">
0.0666270
</td>
<td style="text-align:right;">
0.4544088
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
EPS8/CPT1C/CACNG2/ZDHHC5/AGAP3/ATG5/GRID2/ADAM22/TNIK/KALRN/GPC4/CACNA2D2/EPB41L3/GABARAP/NEDD4/OPHN1/RNF220
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0099504" class="uri">GO:0099504</a>
</td>
<td style="text-align:left;">
<a href="GO:0099504" class="uri">GO:0099504</a>
</td>
<td style="text-align:left;">
synaptic vesicle cycle (<a href="GO:0099504" class="uri">GO:0099504</a>)
</td>
<td style="text-align:right;">
124
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0015391
</td>
<td style="text-align:right;">
0.0005665
</td>
<td style="text-align:right;">
2.716692
</td>
<td style="text-align:right;">
0.2658276
</td>
<td style="text-align:right;">
0.0715974
</td>
<td style="text-align:right;">
0.4600578
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
ATG7/NRXN1/ARHGDIA/UNC13C/MCTP1/ERC2/FBXL20/STXBP5L/SV2B/SLC4A8/EFR3A/BRSK1/SLC17A8/CLCN3/ATP6V1C1/ATP6V0A4/STON2/AP3M2/OPHN1/CXADR
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0099536" class="uri">GO:0099536</a>
</td>
<td style="text-align:left;">
<a href="GO:0099536" class="uri">GO:0099536</a>
</td>
<td style="text-align:left;">
synaptic signaling (<a href="GO:0099536" class="uri">GO:0099536</a>)
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0013507
</td>
<td style="text-align:right;">
0.0004851
</td>
<td style="text-align:right;">
2.784359
</td>
<td style="text-align:right;">
0.2704906
</td>
<td style="text-align:right;">
0.0776564
</td>
<td style="text-align:right;">
0.4633247
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
PLCB1/ABHD6/TENM2/CADM1/FARP1/AKAP12/PDE4A/PLPPR4/PTPRA/MAPK3/SHANK1/CAMKV/RPS6KB1/GSK3B/CHRNA4/NR3C2/NRN1/SYT12/NRXN2/KCNK2/INA/NEFL/NEFH/ATG5
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0099537" class="uri">GO:0099537</a>
</td>
<td style="text-align:left;">
<a href="GO:0099537" class="uri">GO:0099537</a>
</td>
<td style="text-align:left;">
trans-synaptic signaling (<a href="GO:0099537" class="uri">GO:0099537</a>)
</td>
<td style="text-align:right;">
131
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0013964
</td>
<td style="text-align:right;">
0.0004943
</td>
<td style="text-align:right;">
2.824992
</td>
<td style="text-align:right;">
0.2742737
</td>
<td style="text-align:right;">
0.0815549
</td>
<td style="text-align:right;">
0.4669925
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
PLCB1/ABHD6/CADM1/FARP1/AKAP12/PDE4A/PLPPR4/PTPRA/NCAN/MAPK3/SHANK1/CAMKV/RPS6KB1/HTR1A/CHRNA4/NR3C2/NRN1/SYT12/NRXN2/KCNK2/INA/NEFL/NEFH/ATG5
</td>
</tr>
<tr>
<td style="text-align:left;">
SYNGO:postsynprocess
</td>
<td style="text-align:left;">
SYNGO:postsynprocess
</td>
<td style="text-align:left;">
process in the postsynapse
</td>
<td style="text-align:right;">
158
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0012515
</td>
<td style="text-align:right;">
0.0004827
</td>
<td style="text-align:right;">
2.592633
</td>
<td style="text-align:right;">
0.2540571
</td>
<td style="text-align:right;">
0.0595447
</td>
<td style="text-align:right;">
0.4485695
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
NR3C2/HCN1/ANO6/GABRA2/GRIN2A/CHRNA3/GRIA1/GABRA1/GABRG2/GRIA3/KCNA2/KCNK1/CACNG4/EFNB2/CPT1C/AGAP3/CAMK2G/ATG5/GRID2/NSG2/ADAM22/KALRN/GPC4/GABARAP/NEDD4/OPHN1/RNF220/SYT6
</td>
</tr>
<tr>
<td style="text-align:left;">
SYNGO:presynprocess
</td>
<td style="text-align:left;">
SYNGO:presynprocess
</td>
<td style="text-align:left;">
process in the presynapse
</td>
<td style="text-align:right;">
179
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
0.0016795
</td>
<td style="text-align:right;">
0.0006074
</td>
<td style="text-align:right;">
2.764976
</td>
<td style="text-align:right;">
0.2705764
</td>
<td style="text-align:right;">
0.0763288
</td>
<td style="text-align:right;">
0.4648240
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:right;">
0.1666667
</td>
<td style="text-align:left;">
spin_brain
</td>
<td style="text-align:left;">
SV2B/ERC2/NPY/TSPOAP1/CACNA1A/CACNB2/CACNB4/GRIA3/GABRA2/GABRB1/KCTD12/KCTD16/NRXN1/TBC1D24/UNC13C/STX1B/MCTP1/RELN/PRKCA/STXBP5L/EFR3A/BRSK1/SLC17A8/CLCN3/ATP6V1C1/ATP6V1G2/ATP6V0A4/RAB27B/AP3M2/LRRK2/SYT10/RAB10/SIPA1L2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="visualization">4. Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<p>This section covers the visualization of the results. Note: the upsetplot, heatplot available for brainenrich resutls are not applicable for these results.</p>
<div class="section level3">
<h3 id="gene-concept-network">4.1. Gene-Concept Network<a class="anchor" aria-label="anchor" href="#gene-concept-network"></a>
</h3>
<p>We will visualize the gene-concept network.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">geneList</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">@</span><span class="va">geneList</span></span>
<span><span class="va">showCategory</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">showID</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">@</span><span class="va">result</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">showCategory</span><span class="op">]</span></span>
<span><span class="va">show.geneList</span> <span class="op">&lt;-</span> <span class="va">geneList</span><span class="op">[</span><span class="va">showID</span><span class="op">]</span></span>
<span><span class="va">color_palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0197b2"</span>, <span class="st">"white"</span>, <span class="st">"orange"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">101</span><span class="op">)</span></span>
<span><span class="va">geneList_colors</span> <span class="op">&lt;-</span> <span class="va">color_palette</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">show.geneList</span>, breaks <span class="op">=</span> <span class="va">breaks</span>, labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">named_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">geneList_colors</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">show.geneList</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggtangle/man/cnetplot.html" class="external-link">cnetplot</a></span><span class="op">(</span><span class="va">res</span>,</span>
<span>  layout <span class="op">=</span> <span class="st">"kk"</span>,</span>
<span>  color.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>category <span class="op">=</span> <span class="va">named_colors</span><span class="op">)</span>,</span>
<span>  showCategory <span class="op">=</span> <span class="va">showCategory</span>, cex.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    category_node <span class="op">=</span> <span class="fl">1</span>, gene_node <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>    category_label <span class="op">=</span> <span class="fl">1.2</span>, gene_label <span class="op">=</span> <span class="fl">0.6</span></span>
<span>  <span class="op">)</span>,</span>
<span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="va">color_palette</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"t value"</span><span class="op">)</span></span></code></pre></div>
<p><img src="brainscore_demo_files/figure-html/unnamed-chunk-13-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="dot-plot">4.2. Dot Plot<a class="anchor" aria-label="anchor" href="#dot-plot"></a>
</h3>
<p>We will create a dot plot to visualize the results.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/dotplot.html" class="external-link">dotplot</a></span><span class="op">(</span><span class="va">res</span>, x <span class="op">=</span> <span class="st">"t_Value"</span>, label_format <span class="op">=</span> <span class="fl">50</span>, showCategory <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Correlation"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span></span>
<span>    high <span class="op">=</span> <span class="st">"#0197b2"</span>, low <span class="op">=</span> <span class="st">"orange"</span>,</span>
<span>    space <span class="op">=</span> <span class="st">"Lab"</span>, name <span class="op">=</span> <span class="st">"pval"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="brainscore_demo_files/figure-html/unnamed-chunk-14-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhipeng Cao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
