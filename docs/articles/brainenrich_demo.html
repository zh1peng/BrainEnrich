<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>brainenrich (demo):Enrichment analysis of group-level IDPs â€¢ BrainEnrich</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="brainenrich (demo):Enrichment analysis of group-level IDPs">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BrainEnrich</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/brainenrich_demo.html">brainenrich (demo):Enrichment analysis of group-level IDPs</a></li>
    <li><a class="dropdown-item" href="../articles/brainscore.simulate_demo.html">Simulation analysis of brainscore</a></li>
    <li><a class="dropdown-item" href="../articles/brainscore_demo.html">Enrichment analysis of individual-level IDPs</a></li>
    <li><a class="dropdown-item" href="../articles/hpc_helper_demo.html">How to precompute null gene set scores and do simulation on HPC with slurm</a></li>
    <li><a class="dropdown-item" href="../articles/prepare_annoDat.html">How to prepare gene sets (annoDat) for the analysis</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>brainenrich (demo):Enrichment analysis of group-level IDPs</h1>
            
      

      <div class="d-none name"><code>brainenrich_demo.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This tutorial demonstrates how to perform an enrichment analysis of
derived group-level statistics using the <code>BrainEnrich</code>
package. We will use effect size maps of Bipolar Disorders (BD) and gene
expression data to identify significant gene sets.</p>
</div>
<div class="section level2">
<h2 id="load-the-required-libraries">0. Load the required libraries:<a class="anchor" aria-label="anchor" href="#load-the-required-libraries"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://zh1peng.github.io/BrainEnrich/" class="external-link">BrainEnrich</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/biomedical-knowledge-mining-book/" class="external-link">enrichplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ggseg/ggseg" class="external-link">ggseg</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prepare-data-for-the-analysis">1. Prepare Data for the Analysis<a class="anchor" aria-label="anchor" href="#prepare-data-for-the-analysis"></a>
</h2>
<div class="section level3">
<h3 id="load-brain_data-effect-size-maps-of-bipolar-disorders">1.1. Load brain_data (effect size maps of Bipolar Disorders)<a class="anchor" aria-label="anchor" href="#load-brain_data-effect-size-maps-of-bipolar-disorders"></a>
</h3>
<p>We will load brain data that contains the effect size maps of Bipolar
Disorders. This data includes case-control comparisons of regional
cortical thickness.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load brain data from the package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">brain_data</span><span class="op">)</span></span>
<span><span class="co"># Display the structure of the brain data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">brain_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    34 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;  $ BD: num  -0.207 -0.095 -0.266 -0.056 -0.036 -0.288 -0.265 -0.25 -0.132 -0.156 ...</span></span></code></pre></div>
<div class="section level4">
<h4 id="show-effect-size-map-for-bd">Show effect size map for BD<a class="anchor" aria-label="anchor" href="#show-effect-size-map-for-bd"></a>
</h4>
<p>Visualize the effect size map to understand the regional differences
in cortical thickness.</p>
<p>First, we define a plot function (this is not included in the package
as it is not a core function).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Plot Brain Data</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' This function creates a brain plot using the ggplot2 and ggseg packages.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' df2plot A data frame containing the data to plot.</span></span>
<span><span class="co">#' ats A character string indicating the atlas to use ('dx', 'dk', 'aseg').</span></span>
<span><span class="co">#' what2plot A character string indicating the variable to plot ('statistic').</span></span>
<span><span class="co">#' filterby A character string indicating the filter to apply ('p.value', 'p.adj', 'none').</span></span>
<span><span class="co">#' title2show A character string indicating the title of the plot.</span></span>
<span><span class="co">#' limit2show A numeric vector of length 2 indicating the limits for the color scale.</span></span>
<span><span class="co">#' legend2show A character string indicating the legend title.</span></span>
<span><span class="co">#' hide_legend A logical value indicating whether to hide the legend.</span></span>
<span><span class="co">#' hem A character string indicating which hemisphere to plot ('both', 'left', 'right').</span></span>
<span><span class="co">#' low A character string indicating the color for the low end of the scale.</span></span>
<span><span class="co">#' mid A character string indicating the color for the midpoint of the scale.</span></span>
<span><span class="co">#' high A character string indicating the color for the high end of the scale.</span></span>
<span><span class="co">#' sufix2remove A character string indicating the suffix to remove from labels.</span></span>
<span><span class="co">#' return A ggplot2 object.</span></span>
<span></span>
<span><span class="va">plot_brain</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df2plot</span>,</span>
<span>                       <span class="va">ats</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dx"</span>, <span class="st">"dk"</span>, <span class="st">"aseg"</span><span class="op">)</span>,</span>
<span>                       <span class="va">what2plot</span> <span class="op">=</span> <span class="st">"statistic"</span>,</span>
<span>                       <span class="va">filterby</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p.value"</span>, <span class="st">"p.adj"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>                       <span class="va">title2show</span> <span class="op">=</span> <span class="st">""</span>,</span>
<span>                       <span class="va">limit2show</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>                       <span class="va">legend2show</span> <span class="op">=</span> <span class="st">"Stat"</span>,</span>
<span>                       <span class="va">hide_legend</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       <span class="va">hem</span> <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>                       <span class="va">low</span> <span class="op">=</span> <span class="st">"steelblue1"</span>,</span>
<span>                       <span class="va">mid</span> <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                       <span class="va">high</span> <span class="op">=</span> <span class="st">"firebrick1"</span>,</span>
<span>                       <span class="va">sufix2remove</span> <span class="op">=</span> <span class="st">"_thickavg"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Match arguments with allowed values</span></span>
<span>  <span class="va">ats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html" class="external-link">match.arg</a></span><span class="op">(</span><span class="va">ats</span><span class="op">)</span></span>
<span>  <span class="va">filterby</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html" class="external-link">match.arg</a></span><span class="op">(</span><span class="va">filterby</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Apply filters based on p-values</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">filterby</span> <span class="op">==</span> <span class="st">"p.value"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df2plot</span> <span class="op">&lt;-</span> <span class="va">df2plot</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">filterby</span> <span class="op">==</span> <span class="st">"p.adj"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df2plot</span> <span class="op">&lt;-</span> <span class="va">df2plot</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">p.adj</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">filterby</span> <span class="op">==</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df2plot</span> <span class="op">&lt;-</span> <span class="va">df2plot</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Modify labels and join data based on anatomical terms</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">ats</span> <span class="op">==</span> <span class="st">"dx"</span> <span class="op">||</span> <span class="va">ats</span> <span class="op">==</span> <span class="st">"dk"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">atlas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">ats</span> <span class="op">==</span> <span class="st">"dx"</span>, <span class="st">"desterieux"</span>, <span class="st">"dk"</span><span class="op">)</span></span>
<span>    <span class="va">atlas_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-reflect.html" class="external-link">getExportedValue</a></span><span class="op">(</span><span class="st">"ggseg"</span>, <span class="va">atlas</span><span class="op">)</span></span>
<span>    <span class="va">df2plot</span> <span class="op">&lt;-</span> <span class="va">df2plot</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".*L_"</span>, <span class="st">"lh_"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">label</span><span class="op">)</span>,</span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".*R_"</span>, <span class="st">"rh_"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">label</span><span class="op">)</span>,</span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="va">sufix2remove</span>, <span class="st">""</span>, <span class="va">.data</span><span class="op">$</span><span class="va">label</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/ggseg/man/brain_join.html" class="external-link">brain_join</a></span><span class="op">(</span><span class="va">atlas_data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/ggseg/man/reposition_brain.html" class="external-link">reposition_brain</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">". ~ hemi + side"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">ats</span> <span class="op">==</span> <span class="st">"aseg"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">atlas_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-reflect.html" class="external-link">getExportedValue</a></span><span class="op">(</span><span class="st">"ggseg"</span>, <span class="st">"aseg"</span><span class="op">)</span> <span class="co"># ggseg::aseg</span></span>
<span>    <span class="va">df2plot</span> <span class="op">&lt;-</span> <span class="va">df2plot</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"SV_L_"</span>, <span class="st">"Left-"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">label</span><span class="op">)</span>, <span class="co"># Replace "SV_L_" with "Left-"</span></span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"SV_R_"</span>, <span class="st">"Right-"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">label</span><span class="op">)</span>, <span class="co"># Replace "SV_R_" with "Right-"</span></span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"thal"</span>, <span class="st">"Thalamus-Proper"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">label</span><span class="op">)</span>, <span class="co"># Replace "thal" with "Thalamus-Proper"</span></span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"caud"</span>, <span class="st">"Caudate"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">label</span><span class="op">)</span>, <span class="co"># Replace "caud" with "Caudate"</span></span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"put"</span>, <span class="st">"Putamen"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">label</span><span class="op">)</span>, <span class="co"># Replace "put" with "Putamen"</span></span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"pal"</span>, <span class="st">"Pallidum"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">label</span><span class="op">)</span>, <span class="co"># Replace "pal" with "Pallidum"</span></span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"hippo"</span>, <span class="st">"Hippocampus"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">label</span><span class="op">)</span>, <span class="co"># Replace "hippo" with "Hippocampus"</span></span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"amyg"</span>, <span class="st">"Amygdala"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">label</span><span class="op">)</span>, <span class="co"># Replace "amyg" with "Amygdala"</span></span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"accumb"</span>, <span class="st">"Accumben-area"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">label</span><span class="op">)</span>, <span class="co"># Replace "accumb" with "Accumben-area"</span></span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"LatVent"</span>, <span class="st">"Lateral-Ventricle"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">label</span><span class="op">)</span> <span class="co"># Replace "LatVent" with "Lateral-Ventricle"</span></span>
<span>      <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Accumben-area"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/ggseg/man/brain_join.html" class="external-link">brain_join</a></span><span class="op">(</span><span class="va">atlas_data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">side</span> <span class="op">==</span> <span class="st">"coronal"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Apply conditional filtering based on hemisphere</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">hem</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"right"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df2plot</span> <span class="op">&lt;-</span> <span class="va">df2plot</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">hemi</span> <span class="op">==</span> <span class="va">hem</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Construct the plot</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">df2plot</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">what2plot</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>midpoint <span class="op">=</span> <span class="fl">0</span>, low <span class="op">=</span> <span class="va">low</span>, mid <span class="op">=</span> <span class="va">mid</span>, high <span class="op">=</span> <span class="va">high</span>, space <span class="op">=</span> <span class="st">"Lab"</span>, limits <span class="op">=</span> <span class="va">limit2show</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="va">title2show</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">legend2show</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">hide_legend</span><span class="op">)</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df2plot</span> <span class="op">&lt;-</span> <span class="va">brain_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"label"</span><span class="op">)</span></span>
<span><span class="fu">plot_brain</span><span class="op">(</span><span class="va">df2plot</span>,</span>
<span>  ats <span class="op">=</span> <span class="st">"dk"</span>, filterby <span class="op">=</span> <span class="st">"none"</span>, limit2show <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  what2plot <span class="op">=</span> <span class="st">"BD"</span>, hem <span class="op">=</span> <span class="st">"left"</span>, low <span class="op">=</span> <span class="st">"#0197b2"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"orange"</span>,</span>
<span>  legend2show <span class="op">=</span> <span class="st">"Effect Size"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="brainenrich_demo_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="create-perm_id-for-the-analysis">1.2. Create perm_id for the Analysis<a class="anchor" aria-label="anchor" href="#create-perm_id-for-the-analysis"></a>
</h3>
<p>perm_id is a list of permutations of brain regions with a spinning
approach while trying to maintain the spatial structure of the brain. It
is used to generate null distributions for the enrichment analysis. If
you use this function to create perm_ids, consider citing the original
source at <a href="https://github.com/frantisekvasa/rotate_parcellation" class="external-link uri">https://github.com/frantisekvasa/rotate_parcellation</a> and
relevant papers.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read the centroid coordinates of the brain regions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">coord_dk_lh</span><span class="op">)</span></span>
<span><span class="va">perm_id_dk_lh_5000</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rotate_parcellation.html">rotate_parcellation</a></span><span class="op">(</span>coord.l <span class="op">=</span> <span class="va">coord_dk_lh</span>, nrot <span class="op">=</span> <span class="fl">5000</span>, seed <span class="op">=</span> <span class="fl">2024</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="here-we-load-the-precomputed-perm_id-directly-from-the-package-">Here, we load the precomputed perm_id directly from the
package.<a class="anchor" aria-label="anchor" href="#here-we-load-the-precomputed-perm_id-directly-from-the-package-"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">perm_id_dk_lh_5000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">perm_id_dk_lh_5000</span><span class="op">)</span></span>
<span><span class="co">#&gt;  num [1:34, 1:5000] 5 29 19 10 16 24 15 9 7 20 ...</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="load-gene-expression-data-for-the-analysis">1.3. Load gene expression data for the Analysis<a class="anchor" aria-label="anchor" href="#load-gene-expression-data-for-the-analysis"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_geneExp.html">get_geneExp</a></span><span class="op">(</span>atlas <span class="op">=</span> <span class="st">"desikan"</span>, rdonor <span class="op">=</span> <span class="st">"r0.4"</span>, hem <span class="op">=</span> <span class="st">"L"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">gene_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;  num [1:34, 1:6513] 0.469 0.607 0.512 0.341 0.664 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:34] "L_bankssts" "L_caudalanteriorcingulate" "L_caudalmiddlefrontal" "L_cuneus" ...</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:6513] "A1BG" "A1BG-AS1" "AACS" "AADAT" ...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-go-mf-for-the-analysis">1.4. Load GO MF for the Analysis<a class="anchor" aria-label="anchor" href="#load-go-mf-for-the-analysis"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annoData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_annoData.html">get_annoData</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"GO_MF"</span><span class="op">)</span></span>
<span><span class="va">geneSetList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_geneSetList.html">get_geneSetList</a></span><span class="op">(</span><span class="va">annoData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">geneSetList</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5060</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Number of MF terms: %d"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">geneSetList</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Number of MF terms: 5060"</span></span></code></pre></div>
<div class="section level4">
<h4 id="filter-the-genesetlist-optional-">Filter the geneSetList (optional).<a class="anchor" aria-label="anchor" href="#filter-the-genesetlist-optional-"></a>
</h4>
</div>
<div class="section level4">
<h4 id="this-step-is-embedded-in-the-brainenrich-function--here-is-just-to-show-how-it-is-filtered-">This step is embedded in the <code>brainenrich</code> function. Here
is just to show how it is filtered.<a class="anchor" aria-label="anchor" href="#this-step-is-embedded-in-the-brainenrich-function--here-is-just-to-show-how-it-is-filtered-"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">selected.gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_geneSetList.html">filter_geneSetList</a></span><span class="op">(</span>bg_genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gene_data</span><span class="op">)</span>, geneSetList <span class="op">=</span> <span class="va">geneSetList</span>, minGSSize <span class="op">=</span> <span class="fl">20</span>, maxGSSize <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%d MF terms have gene size ranging between 20 and 200"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">selected.gs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="run-the-analysis">2. Run the Analysis<a class="anchor" aria-label="anchor" href="#run-the-analysis"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brainenrich.html">brainenrich</a></span><span class="op">(</span></span>
<span>  brain_data <span class="op">=</span> <span class="va">brain_data</span>,</span>
<span>  gene_data <span class="op">=</span> <span class="va">gene_data</span>,</span>
<span>  annoData <span class="op">=</span> <span class="va">annoData</span>,</span>
<span>  perm_id <span class="op">=</span> <span class="va">perm_id_dk_lh_5000</span>,</span>
<span>  cor_method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  aggre_method <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  null_model <span class="op">=</span> <span class="st">"spin_brain"</span>,</span>
<span>  n_perm <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  minGSSize <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  maxGSSize <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  pvalueCutoff <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  threshold_type <span class="op">=</span> <span class="st">"sd"</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualize-the-results">3. Visualize the Results<a class="anchor" aria-label="anchor" href="#visualize-the-results"></a>
</h2>
<p>The res is a gseaResult object that is commonly used in
clusterProfiler and DOSE packages. This means that we can use some
existing functions (e.g., those from enrichplot package) to visualize
the results.</p>
<div class="section level3">
<h3 id="upset-plot">3.1. Upset Plot<a class="anchor" aria-label="anchor" href="#upset-plot"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/upsetplot-methods.html" class="external-link">upsetplot</a></span><span class="op">(</span><span class="va">res</span>, top <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p><img src="brainenrich_demo_files/figure-html/unnamed-chunk-11-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="gene-concept-network">3.2. Gene-Concept Network<a class="anchor" aria-label="anchor" href="#gene-concept-network"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">geneList</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">@</span><span class="va">geneList</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/cnetplot.html" class="external-link">cnetplot</a></span><span class="op">(</span><span class="va">res</span>,</span>
<span>  layout <span class="op">=</span> <span class="st">"kk"</span>, color_category <span class="op">=</span> <span class="st">"#a6a6a6"</span>, foldChange <span class="op">=</span> <span class="va">geneList</span>,</span>
<span>  <span class="co"># color.params = list(foldChange = geneList),</span></span>
<span>  showCategory <span class="op">=</span> <span class="fl">10</span>, cex.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    category_node <span class="op">=</span> <span class="fl">1</span>, gene_node <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>    category_label <span class="op">=</span> <span class="fl">1.2</span>, gene_label <span class="op">=</span> <span class="fl">0.6</span></span>
<span>  <span class="op">)</span>,</span>
<span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient2</a></span><span class="op">(</span></span>
<span>  midpoint <span class="op">=</span> <span class="fl">0</span>, low <span class="op">=</span> <span class="st">"#0197b2"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"orange"</span>,</span>
<span>  space <span class="op">=</span> <span class="st">"Lab"</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Association"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="brainenrich_demo_files/figure-html/unnamed-chunk-12-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="dot-plot">3.3. Dot Plot<a class="anchor" aria-label="anchor" href="#dot-plot"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/dotplot.html" class="external-link">dotplot</a></span><span class="op">(</span><span class="va">res</span>, x <span class="op">=</span> <span class="st">"gsScore"</span>, label_format <span class="op">=</span> <span class="fl">50</span>, showCategory <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"GS score"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span></span>
<span>    high <span class="op">=</span> <span class="st">"#0197b2"</span>, low <span class="op">=</span> <span class="st">"orange"</span>,</span>
<span>    space <span class="op">=</span> <span class="st">"Lab"</span>, name <span class="op">=</span> <span class="st">"p.adjusted"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="brainenrich_demo_files/figure-html/unnamed-chunk-13-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="heatplot">3.4. Heatplot<a class="anchor" aria-label="anchor" href="#heatplot"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/heatplot.html" class="external-link">heatplot</a></span><span class="op">(</span><span class="va">res</span>, foldChange <span class="op">=</span> <span class="va">geneList</span>, label_format <span class="op">=</span> <span class="fl">50</span>, showCategory <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span></span>
<span>    midpoint <span class="op">=</span> <span class="fl">0</span>, low <span class="op">=</span> <span class="st">"#0197b2"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"orange"</span>,</span>
<span>    space <span class="op">=</span> <span class="st">"Lab"</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Association"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="brainenrich_demo_files/figure-html/unnamed-chunk-14-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="tree-plot-based-on-term-similarity">3.5. Tree plot based on term similarity<a class="anchor" aria-label="anchor" href="#tree-plot-based-on-term-similarity"></a>
</h3>
<p>Note: This requires GOSemSim and org.Hs.eg.db packages.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">GOSemSim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GOSemSim/man/godata.html" class="external-link">godata</a></span><span class="op">(</span>annoDb <span class="op">=</span> <span class="st">"org.Hs.eg.db"</span>, ont <span class="op">=</span> <span class="st">"MF"</span>, keytype <span class="op">=</span> <span class="st">"SYMBOL"</span>, computeIC <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># computeIC=FALSE when use Wang method</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/pairwise_termsim.html" class="external-link">pairwise_termsim</a></span><span class="op">(</span><span class="va">res</span>, method <span class="op">=</span> <span class="st">"Wang"</span>, semData <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/treeplot.html" class="external-link">treeplot</a></span><span class="op">(</span><span class="va">res</span>,</span>
<span>  showCategory <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  cex_category <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  nCluster <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  nWords <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"p.adjust"</span>,</span>
<span>  offset <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.46</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="brainenrich_demo_files/figure-html/unnamed-chunk-15-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhipeng Cao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
